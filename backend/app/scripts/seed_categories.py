"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ —Ç–æ–≤–∞—Ä–æ–≤ –∏ —É—Å–ª—É–≥
–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –¥–ª—è –ö—ã—Ä–≥—ã–∑—Å—Ç–∞–Ω–∞
"""
import asyncio
from sqlalchemy.ext.asyncio import AsyncSession
from app.database.session import AsyncSessionLocal
from app.models.product import Category


# –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
CATEGORIES = {
    "–¢–æ–≤–∞—Ä—ã": {
        "level": 1,
        "slug": "tovary",
        "icon": "shopping_bag",
        "children": {
            "–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞": {
                "slug": "elektronika",
                "icon": "devices",
                "children": [
                    "–¢–µ–ª–µ—Ñ–æ–Ω—ã –∏ –∞–∫—Å–µ—Å—Å—É–∞—Ä—ã",
                    "–ù–æ—É—Ç–±—É–∫–∏ –∏ –∫–æ–º–ø—å—é—Ç–µ—Ä—ã",
                    "–ü–ª–∞–Ω—à–µ—Ç—ã –∏ —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–µ –∫–Ω–∏–≥–∏",
                    "–¢–í, –∞—É–¥–∏–æ, –≤–∏–¥–µ–æ",
                    "–§–æ—Ç–æ –∏ –≤–∏–¥–µ–æ–∫–∞–º–µ—Ä—ã",
                    "–ò–≥—Ä–æ–≤—ã–µ –ø—Ä–∏—Å—Ç–∞–≤–∫–∏ –∏ –∏–≥—Ä—ã",
                    "–£–º–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∏ –≥–∞–¥–∂–µ—Ç—ã",
                    "–ö–æ–º–ø–ª–µ–∫—Ç—É—é—â–∏–µ –¥–ª—è –ü–ö",
                    "–û—Ñ–∏—Å–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞",
                ]
            },
            "–û–¥–µ–∂–¥–∞ –∏ –æ–±—É–≤—å": {
                "slug": "odezhda-i-obuv",
                "icon": "checkroom",
                "children": [
                    "–ñ–µ–Ω—Å–∫–∞—è –æ–¥–µ–∂–¥–∞",
                    "–ú—É–∂—Å–∫–∞—è –æ–¥–µ–∂–¥–∞",
                    "–î–µ—Ç—Å–∫–∞—è –æ–¥–µ–∂–¥–∞",
                    "–ñ–µ–Ω—Å–∫–∞—è –æ–±—É–≤—å",
                    "–ú—É–∂—Å–∫–∞—è –æ–±—É–≤—å",
                    "–î–µ—Ç—Å–∫–∞—è –æ–±—É–≤—å",
                    "–ê–∫—Å–µ—Å—Å—É–∞—Ä—ã –∏ —É–∫—Ä–∞—à–µ–Ω–∏—è",
                    "–°—É–º–∫–∏ –∏ —Ä—é–∫–∑–∞–∫–∏",
                    "–°–≤–∞–¥–µ–±–Ω—ã–µ –ø–ª–∞—Ç—å—è",
                ]
            },
            "–î–æ–º –∏ —Å–∞–¥": {
                "slug": "dom-i-sad",
                "icon": "home",
                "children": [
                    "–ú–µ–±–µ–ª—å",
                    "–ü–æ—Å—É–¥–∞ –∏ –∫—É—Ö–æ–Ω–Ω–∞—è —É—Ç–≤–∞—Ä—å",
                    "–ë—ã—Ç–æ–≤–∞—è —Ç–µ—Ö–Ω–∏–∫–∞",
                    "–†–µ–º–æ–Ω—Ç –∏ —Å—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ",
                    "–¢–µ–∫—Å—Ç–∏–ª—å –∏ –∫–æ–≤—Ä—ã",
                    "–û—Å–≤–µ—â–µ–Ω–∏–µ –∏ —ç–ª–µ–∫—Ç—Ä–∏–∫–∞",
                    "–°–∞–Ω—Ç–µ—Ö–Ω–∏–∫–∞",
                    "–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã",
                    "–†–∞—Å—Ç–µ–Ω–∏—è –∏ —Å–µ–º–µ–Ω–∞",
                    "–°–∞–¥–æ–≤–∞—è —Ç–µ—Ö–Ω–∏–∫–∞ –∏ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å",
                ]
            },
            "–î–µ—Ç—Å–∫–∏–µ —Ç–æ–≤–∞—Ä—ã": {
                "slug": "detskie-tovary",
                "icon": "child_care",
                "children": [
                    "–ö–æ–ª—è—Å–∫–∏ –∏ –∞–≤—Ç–æ–∫—Ä–µ—Å–ª–∞",
                    "–ò–≥—Ä—É—à–∫–∏",
                    "–î–µ—Ç—Å–∫–∞—è –º–µ–±–µ–ª—å",
                    "–¢–æ–≤–∞—Ä—ã –¥–ª—è –Ω–æ–≤–æ—Ä–æ–∂–¥–µ–Ω–Ω—ã—Ö",
                    "–î–µ—Ç—Å–∫–æ–µ –ø–∏—Ç–∞–Ω–∏–µ",
                    "–®–∫–æ–ª—å–Ω—ã–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏",
                ]
            },
            "–ö—Ä–∞—Å–æ—Ç–∞ –∏ –∑–¥–æ—Ä–æ–≤—å–µ": {
                "slug": "krasota-i-zdorovye",
                "icon": "spa",
                "children": [
                    "–ü–∞—Ä—Ñ—é–º–µ—Ä–∏—è",
                    "–ö–æ—Å–º–µ—Ç–∏–∫–∞ –∏ —É—Ö–æ–¥",
                    "–°—Ä–µ–¥—Å—Ç–≤–∞ –≥–∏–≥–∏–µ–Ω—ã",
                    "–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ —Ç–æ–≤–∞—Ä—ã",
                    "–ë–ê–î—ã –∏ –≤–∏—Ç–∞–º–∏–Ω—ã",
                    "–ú–∞—Å—Å–∞–∂—ë—Ä—ã –∏ —Ç—Ä–µ–Ω–∞–∂—ë—Ä—ã",
                ]
            },
            "–°–ø–æ—Ä—Ç –∏ –æ—Ç–¥—ã—Ö": {
                "slug": "sport-i-otdyh",
                "icon": "sports_soccer",
                "children": [
                    "–°–ø–æ—Ä—Ç–∏–≤–Ω–∞—è –æ–¥–µ–∂–¥–∞ –∏ –æ–±—É–≤—å",
                    "–¢—Ä–µ–Ω–∞–∂—ë—Ä—ã",
                    "–í–µ–ª–æ—Å–∏–ø–µ–¥—ã",
                    "–¢—É—Ä–∏–∑–º –∏ –∫–µ–º–ø–∏–Ω–≥",
                    "–ó–∏–º–Ω–∏–µ –≤–∏–¥—ã —Å–ø–æ—Ä—Ç–∞",
                    "–†—ã–±–∞–ª–∫–∞ –∏ –æ—Ö–æ—Ç–∞",
                    "–ù–∞—Å—Ç–æ–ª—å–Ω—ã–µ –∏–≥—Ä—ã –∏ —Ö–æ–±–±–∏",
                ]
            },
            "–ê–≤—Ç–æ –∏ –º–æ—Ç–æ": {
                "slug": "avto-i-moto",
                "icon": "directions_car",
                "children": [
                    "–õ–µ–≥–∫–æ–≤—ã–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏",
                    "–ì—Ä—É–∑–æ–≤—ã–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏",
                    "–ê–≤—Ç–æ–±—É—Å—ã –∏ –º–∏–∫—Ä–æ–∞–≤—Ç–æ–±—É—Å—ã",
                    "–ú–æ—Ç–æ—Ü–∏–∫–ª—ã –∏ –º–æ—Ç–æ—Ç–µ—Ö–Ω–∏–∫–∞",
                    "–í–æ–¥–Ω—ã–π —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç",
                    "–ó–∞–ø—á–∞—Å—Ç–∏ –∏ –∞–∫—Å–µ—Å—Å—É–∞—Ä—ã",
                    "–®–∏–Ω—ã –∏ –¥–∏—Å–∫–∏",
                    "–ê–≤—Ç–æ—ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞",
                    "–ê–≤—Ç–æ–º–æ–±–∏–ª—å–Ω–∞—è —Ö–∏–º–∏—è",
                ]
            },
            "–ù–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å": {
                "slug": "nedvizhimost",
                "icon": "apartment",
                "children": [
                    "–ö–≤–∞—Ä—Ç–∏—Ä—ã",
                    "–ö–æ–º–Ω–∞—Ç—ã",
                    "–î–æ–º–∞ –∏ –¥–∞—á–∏",
                    "–ó–µ–º–µ–ª—å–Ω—ã–µ —É—á–∞—Å—Ç–∫–∏",
                    "–ö–æ–º–º–µ—Ä—á–µ—Å–∫–∞—è –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç—å",
                    "–ì–∞—Ä–∞–∂–∏ –∏ –ø–∞—Ä–∫–æ–≤–∫–∏",
                    "–ü–æ—Å—É—Ç–æ—á–Ω–∞—è –∞—Ä–µ–Ω–¥–∞",
                ]
            },
            "–ü—Ä–æ–¥—É–∫—Ç—ã –ø–∏—Ç–∞–Ω–∏—è": {
                "slug": "produkty-pitaniya",
                "icon": "restaurant",
                "children": [
                    "–ú—è—Å–æ –∏ –ø—Ç–∏—Ü–∞",
                    "–ú–æ–ª–æ—á–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã",
                    "–•–ª–µ–± –∏ –≤—ã–ø–µ—á–∫–∞",
                    "–§—Ä—É–∫—Ç—ã –∏ –æ–≤–æ—â–∏",
                    "–ë–∞–∫–∞–ª–µ—è",
                    "–ù–∞–ø–∏—Ç–∫–∏",
                    "–ö–æ–Ω–¥–∏—Ç–µ—Ä—Å–∫–∏–µ –∏–∑–¥–µ–ª–∏—è",
                    "–ó–∞–º–æ—Ä–æ–∂–µ–Ω–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã",
                    "–ì–æ—Ç–æ–≤–∞—è –µ–¥–∞",
                ]
            },
            "–ö–Ω–∏–≥–∏ –∏ —É—á–µ–±–Ω–∞—è –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞": {
                "slug": "knigi",
                "icon": "menu_book",
                "children": [
                    "–•—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞",
                    "–£—á–µ–±–Ω–∏–∫–∏ –∏ –ø–æ—Å–æ–±–∏—è",
                    "–î–µ—Ç—Å–∫–∏–µ –∫–Ω–∏–≥–∏",
                    "–ù–∞—É—á–Ω–∞—è –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞",
                    "–°–ª–æ–≤–∞—Ä–∏ –∏ —ç–Ω—Ü–∏–∫–ª–æ–ø–µ–¥–∏–∏",
                ]
            },
            "–ñ–∏–≤–æ—Ç–Ω—ã–µ": {
                "slug": "zhivotnye",
                "icon": "pets",
                "children": [
                    "–°–æ–±–∞–∫–∏",
                    "–ö–æ—à–∫–∏",
                    "–ü—Ç–∏—Ü—ã",
                    "–ê–∫–≤–∞—Ä–∏—É–º–Ω—ã–µ —Ä—ã–±–∫–∏",
                    "–°–µ–ª—å—Å–∫–æ—Ö–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω—ã–µ –∂–∏–≤–æ—Ç–Ω—ã–µ",
                    "–¢–æ–≤–∞—Ä—ã –¥–ª—è –∂–∏–≤–æ—Ç–Ω—ã—Ö",
                ]
            },
            "–ë–∏–∑–Ω–µ—Å –∏ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ": {
                "slug": "biznes-i-oborudovanie",
                "icon": "business_center",
                "children": [
                    "–¢–æ—Ä–≥–æ–≤–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ",
                    "–ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ",
                    "–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –¥–ª—è –æ–±—â–µ–ø–∏—Ç–∞",
                    "–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ",
                    "–°–µ–ª—å—Ö–æ–∑—Ç–µ—Ö–Ω–∏–∫–∞",
                    "–ì–æ—Ç–æ–≤—ã–π –±–∏–∑–Ω–µ—Å",
                ]
            },
        }
    },
    "–£—Å–ª—É–≥–∏": {
        "level": 1,
        "slug": "uslugi",
        "icon": "work",
        "children": {
            "–°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ –∏ —Ä–µ–º–æ–Ω—Ç": {
                "slug": "stroitelstvo-i-remont",
                "icon": "construction",
                "children": [
                    "–°—Ç—Ä–æ–∏—Ç–µ–ª—å—Å—Ç–≤–æ –¥–æ–º–æ–≤",
                    "–†–µ–º–æ–Ω—Ç –∫–≤–∞—Ä—Ç–∏—Ä",
                    "–û—Ç–¥–µ–ª–æ—á–Ω—ã–µ —Ä–∞–±–æ—Ç—ã",
                    "–ö—Ä–æ–≤–µ–ª—å–Ω—ã–µ —Ä–∞–±–æ—Ç—ã",
                    "–≠–ª–µ–∫—Ç—Ä–æ–º–æ–Ω—Ç–∞–∂–Ω—ã–µ —Ä–∞–±–æ—Ç—ã",
                    "–°–∞–Ω—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ä–∞–±–æ—Ç—ã",
                    "–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–∫–æ–Ω –∏ –¥–≤–µ—Ä–µ–π",
                    "–õ–∞–Ω–¥—à–∞—Ñ—Ç–Ω—ã–π –¥–∏–∑–∞–π–Ω",
                ]
            },
            "–ö—Ä–∞—Å–æ—Ç–∞ –∏ –∑–¥–æ—Ä–æ–≤—å–µ": {
                "slug": "uslugi-krasoty",
                "icon": "spa",
                "children": [
                    "–ü–∞—Ä–∏–∫–º–∞—Ö–µ—Ä—Å–∫–∏–µ —É—Å–ª—É–≥–∏",
                    "–ú–∞–Ω–∏–∫—é—Ä –∏ –ø–µ–¥–∏–∫—é—Ä",
                    "–ö–æ—Å–º–µ—Ç–æ–ª–æ–≥–∏—è",
                    "–ú–∞—Å—Å–∞–∂",
                    "–°—Ç–æ–º–∞—Ç–æ–ª–æ–≥–∏—è",
                    "–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ —É—Å–ª—É–≥–∏",
                    "–§–∏—Ç–Ω–µ—Å –∏ –π–æ–≥–∞",
                ]
            },
            "–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç–Ω—ã–µ —É—Å–ª—É–≥–∏": {
                "slug": "transportnye-uslugi",
                "icon": "local_shipping",
                "children": [
                    "–ì—Ä—É–∑–æ–ø–µ—Ä–µ–≤–æ–∑–∫–∏",
                    "–ü–∞—Å—Å–∞–∂–∏—Ä—Å–∫–∏–µ –ø–µ—Ä–µ–≤–æ–∑–∫–∏",
                    "–£—Å–ª—É–≥–∏ —Ç–∞–∫—Å–∏",
                    "–ü–µ—Ä–µ–µ–∑–¥—ã –∏ –≥—Ä—É–∑—á–∏–∫–∏",
                    "–ö—É—Ä—å–µ—Ä—Å–∫–∏–µ —É—Å–ª—É–≥–∏",
                    "–≠–≤–∞–∫—É–∞—Ç–æ—Ä",
                ]
            },
            "–†–µ–º–æ–Ω—Ç —Ç–µ—Ö–Ω–∏–∫–∏": {
                "slug": "remont-tehniki",
                "icon": "build",
                "children": [
                    "–†–µ–º–æ–Ω—Ç —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤",
                    "–†–µ–º–æ–Ω—Ç –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤",
                    "–†–µ–º–æ–Ω—Ç –±—ã—Ç–æ–≤–æ–π —Ç–µ—Ö–Ω–∏–∫–∏",
                    "–†–µ–º–æ–Ω—Ç –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π",
                    "–†–µ–º–æ–Ω—Ç —ç–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∏",
                ]
            },
            "–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –∏ –∫—É—Ä—Å—ã": {
                "slug": "obrazovanie",
                "icon": "school",
                "children": [
                    "–†–µ–ø–µ—Ç–∏—Ç–æ—Ä—ã",
                    "–Ø–∑—ã–∫–æ–≤—ã–µ –∫—É—Ä—Å—ã",
                    "–ö–æ–º–ø—å—é—Ç–µ—Ä–Ω—ã–µ –∫—É—Ä—Å—ã",
                    "–ú—É–∑—ã–∫–∞–ª—å–Ω—ã–µ –∑–∞–Ω—è—Ç–∏—è",
                    "–î–µ—Ç—Å–∫–∏–µ –∫—Ä—É–∂–∫–∏",
                    "–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∫—É—Ä—Å—ã",
                ]
            },
            "–û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π": {
                "slug": "meropriyatiya",
                "icon": "celebration",
                "children": [
                    "–¢–∞–º–∞–¥–∞ –∏ –≤–µ–¥—É—â–∏–µ",
                    "–§–æ—Ç–æ –∏ –≤–∏–¥–µ–æ—Å—ä—ë–º–∫–∞",
                    "–ú—É–∑—ã–∫–∞–Ω—Ç—ã –∏ –¥–∏–¥–∂–µ–∏",
                    "–ê—Ä–µ–Ω–¥–∞ –∑–∞–ª–æ–≤",
                    "–ö–µ–π—Ç–µ—Ä–∏–Ω–≥",
                    "–£–∫—Ä–∞—à–µ–Ω–∏–µ –∑–∞–ª–æ–≤",
                    "–°–≤–∞–¥–µ–±–Ω—ã–µ —É—Å–ª—É–≥–∏",
                ]
            },
            "–ë—ã—Ç–æ–≤—ã–µ —É—Å–ª—É–≥–∏": {
                "slug": "bytovye-uslugi",
                "icon": "home_repair_service",
                "children": [
                    "–£–±–æ—Ä–∫–∞ –ø–æ–º–µ—â–µ–Ω–∏–π",
                    "–•–∏–º—á–∏—Å—Ç–∫–∞",
                    "–†–µ–º–æ–Ω—Ç –æ–¥–µ–∂–¥—ã –∏ –æ–±—É–≤–∏",
                    "–ù—è–Ω–∏ –∏ —Å–∏–¥–µ–ª–∫–∏",
                    "–†–µ–º–æ–Ω—Ç –º–µ–±–µ–ª–∏",
                ]
            },
            "IT –∏ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç": {
                "slug": "it-uslugi",
                "icon": "computer",
                "children": [
                    "–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å–∞–π—Ç–æ–≤",
                    "–†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π",
                    "SEO –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ",
                    "–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–æ–≤",
                    "–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö",
                    "IT –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏",
                ]
            },
            "–†–µ–∫–ª–∞–º–∞ –∏ –º–∞—Ä–∫–µ—Ç–∏–Ω–≥": {
                "slug": "reklama-i-marketing",
                "icon": "campaign",
                "children": [
                    "–ù–∞—Ä—É–∂–Ω–∞—è —Ä–µ–∫–ª–∞–º–∞",
                    "–ò–Ω—Ç–µ—Ä–Ω–µ—Ç-—Ä–µ–∫–ª–∞–º–∞",
                    "–ü–æ–ª–∏–≥—Ä–∞—Ñ–∏—è",
                    "–î–∏–∑–∞–π–Ω –∏ –±—Ä–µ–Ω–¥–∏–Ω–≥",
                    "SMM –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ",
                ]
            },
            "–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —É—Å–ª—É–≥–∏": {
                "slug": "yuridicheskie-uslugi",
                "icon": "gavel",
                "children": [
                    "–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏",
                    "–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –±–∏–∑–Ω–µ—Å–∞",
                    "–°–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–æ–≥–æ–≤–æ—Ä–æ–≤",
                    "–ü—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—å—Å—Ç–≤–æ –≤ —Å—É–¥–µ",
                ]
            },
            "–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —É—Å–ª—É–≥–∏": {
                "slug": "finansovye-uslugi",
                "icon": "account_balance",
                "children": [
                    "–ë—É—Ö–≥–∞–ª—Ç–µ—Ä—Å–∫–∏–µ —É—Å–ª—É–≥–∏",
                    "–ê—É–¥–∏—Ç",
                    "–ö—Ä–µ–¥–∏—Ç–æ–≤–∞–Ω–∏–µ",
                    "–°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ",
                ]
            },
            "–¢—É—Ä–∏–∑–º –∏ –æ—Ç–¥—ã—Ö": {
                "slug": "turizm",
                "icon": "flight",
                "children": [
                    "–¢—É—Ä–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –ø—É—Ç—ë–≤–∫–∏",
                    "–í–∏–∑–æ–≤–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞",
                    "–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–µ–ª–µ–π",
                    "–≠–∫—Å–∫—É—Ä—Å–∏–∏",
                    "–ê—Ä–µ–Ω–¥–∞ –∂–∏–ª—å—è –¥–ª—è –æ—Ç–¥—ã—Ö–∞",
                ]
            },
        }
    }
}


async def create_category(
    session: AsyncSession,
    name: str,
    slug: str,
    level: int,
    parent_id: int = None,
    icon: str = None,
    sort_order: int = 0
) -> Category:
    """–°–æ–∑–¥–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é"""
    category = Category(
        name=name,
        slug=slug,
        level=level,
        parent_id=parent_id,
        icon=icon,
        sort_order=sort_order,
        is_active=True
    )
    session.add(category)
    await session.flush()  # Get ID without committing
    return category


async def seed_categories():
    """–ó–∞–ø–æ–ª–Ω–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏"""
    async with AsyncSessionLocal() as session:
        try:
            print("üå± –ù–∞—á–∏–Ω–∞–µ–º –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π...")

            # –°—á—ë—Ç—á–∏–∫–∏
            level1_count = 0
            level2_count = 0
            level3_count = 0

            # –ü—Ä–æ—Ö–æ–¥–∏–º –ø–æ –æ—Å–Ω–æ–≤–Ω—ã–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º (–¢–æ–≤–∞—Ä—ã –∏ –£—Å–ª—É–≥–∏)
            for main_name, main_data in CATEGORIES.items():
                print(f"\nüì¶ –°–æ–∑–¥–∞—ë–º –æ—Å–Ω–æ–≤–Ω—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é: {main_name}")

                # –°–æ–∑–¥–∞—ë–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é —É—Ä–æ–≤–Ω—è 1
                main_category = await create_category(
                    session,
                    name=main_name,
                    slug=main_data["slug"],
                    level=1,
                    icon=main_data.get("icon"),
                    sort_order=level1_count
                )
                level1_count += 1

                # –°–æ–∑–¥–∞—ë–º –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Ä–æ–≤–Ω—è 2
                level2_sort = 0
                for sub_name, sub_data in main_data["children"].items():
                    print(f"  ‚îú‚îÄ {sub_name}")

                    sub_category = await create_category(
                        session,
                        name=sub_name,
                        slug=sub_data["slug"],
                        level=2,
                        parent_id=main_category.id,
                        icon=sub_data.get("icon"),
                        sort_order=level2_sort
                    )
                    level2_count += 1
                    level2_sort += 1

                    # –°–æ–∑–¥–∞—ë–º –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Ä–æ–≤–Ω—è 3
                    if "children" in sub_data and isinstance(sub_data["children"], list):
                        level3_sort = 0
                        for subsub_name in sub_data["children"]:
                            # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º slug –∏–∑ –Ω–∞–∑–≤–∞–Ω–∏—è
                            subsub_slug = f"{sub_data['slug']}-{subsub_name.lower().replace(' ', '-').replace('–∏', 'i').replace('—ë', 'e')}"

                            await create_category(
                                session,
                                name=subsub_name,
                                slug=subsub_slug,
                                level=3,
                                parent_id=sub_category.id,
                                sort_order=level3_sort
                            )
                            level3_count += 1
                            level3_sort += 1

            # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è
            await session.commit()

            print(f"\n‚úÖ –£—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω–æ:")
            print(f"   ‚Ä¢ –ö–∞—Ç–µ–≥–æ—Ä–∏–π —É—Ä–æ–≤–Ω—è 1: {level1_count}")
            print(f"   ‚Ä¢ –ö–∞—Ç–µ–≥–æ—Ä–∏–π —É—Ä–æ–≤–Ω—è 2: {level2_count}")
            print(f"   ‚Ä¢ –ö–∞—Ç–µ–≥–æ—Ä–∏–π —É—Ä–æ–≤–Ω—è 3: {level3_count}")
            print(f"   ‚Ä¢ –í—Å–µ–≥–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–π: {level1_count + level2_count + level3_count}")

        except Exception as e:
            await session.rollback()
            print(f"\n‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–π: {e}")
            raise


if __name__ == "__main__":
    print("=" * 60)
    print("  –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏")
    print("  Bazarlar Online - –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –ö—ã—Ä–≥—ã–∑—Å—Ç–∞–Ω–∞")
    print("=" * 60)
    asyncio.run(seed_categories())
    print("\n" + "=" * 60)
    print("  –ì–æ—Ç–æ–≤–æ!")
    print("=" * 60)
